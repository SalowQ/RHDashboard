import{$ as W,J as Z,L as P,Ma as se,O as A,P as Q,Ra as ne,T as J,W as X,Za as K,a as O,b as Y,c as z,ca as ee,da as v,ea as te,fa as b,ra as ie,xa as re}from"./chunk-OCOETZJA.js";var ae=new P("");var oe=new P("");var ge={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Le=Y(O({},ge),{"[class.ng-submitted]":"isSubmitted"});var i=function(c){return c.SEPARATOR="separator",c.PERCENT="percent",c.IP="IP",c.CPF_CNPJ="CPF_CNPJ",c.MONTH="M",c.MONTHS="M0",c.MINUTE="m",c.HOUR="h",c.HOURS="H",c.MINUTES="m0",c.HOURS_HOUR="Hh",c.SECONDS="s0",c.HOURS_MINUTES_SECONDS="Hh:m0:s0",c.EMAIL_MASK="A*@A*.A*",c.HOURS_MINUTES="Hh:m0",c.MINUTES_SECONDS="m0:s0",c.DAYS_MONTHS_YEARS="d0/M0/0000",c.DAYS_MONTHS="d0/M0",c.DAYS="d0",c.DAY="d",c.SECOND="s",c.LETTER_S="S",c.DOT=".",c.COMMA=",",c.CURLY_BRACKETS_LEFT="{",c.CURLY_BRACKETS_RIGHT="}",c.MINUS="-",c.OR="||",c.HASH="#",c.EMPTY_STRING="",c.SYMBOL_STAR="*",c.SYMBOL_QUESTION="?",c.SLASH="/",c.WHITE_SPACE=" ",c.NUMBER_ZERO="0",c.NUMBER_NINE="9",c.BACKSPACE="Backspace",c.DELETE="Delete",c.ARROW_LEFT="ArrowLeft",c.ARROW_UP="ArrowUp",c.DOUBLE_ZERO="00",c}(i||{}),B=new P("ngx-mask config"),le=new P("new ngx-mask config"),ce=new P("initial ngx-mask config"),_e={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showMaskTyped:!1,instantPrefix:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:!1,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:c=>c,outputTransformFn:c=>c,maskFilled:new W,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},ve=[i.HOURS_MINUTES_SECONDS,i.HOURS_MINUTES,i.MINUTES_SECONDS],Se=[i.PERCENT,i.HOURS_HOUR,i.SECONDS,i.MINUTES,i.SEPARATOR,i.DAYS_MONTHS_YEARS,i.DAYS_MONTHS,i.DAYS,i.MONTHS],ye=(()=>{class c{_config=A(B);dropSpecialCharacters=this._config.dropSpecialCharacters;hiddenInput=this._config.hiddenInput;clearIfNotMatch=this._config.clearIfNotMatch;specialCharacters=this._config.specialCharacters;patterns=this._config.patterns;prefix=this._config.prefix;suffix=this._config.suffix;thousandSeparator=this._config.thousandSeparator;decimalMarker=this._config.decimalMarker;customPattern;showMaskTyped=this._config.showMaskTyped;placeHolderCharacter=this._config.placeHolderCharacter;validation=this._config.validation;separatorLimit=this._config.separatorLimit;allowNegativeNumbers=this._config.allowNegativeNumbers;leadZeroDateTime=this._config.leadZeroDateTime;leadZero=this._config.leadZero;apm=this._config.apm;inputTransformFn=this._config.inputTransformFn;outputTransformFn=this._config.outputTransformFn;keepCharacterPositions=this._config.keepCharacterPositions;instantPrefix=this._config.instantPrefix;triggerOnMaskChange=this._config.triggerOnMaskChange;_shift=new Set;plusOnePosition=!1;maskExpression="";actualValue="";showKeepCharacterExp="";shownMaskExpression=this._config.shownMaskExpression;deletedSpecialCharacter=!1;ipError;cpfCnpjError;applyMask(t,e,n=0,r=!1,o=!1,u=()=>{}){if(!e||typeof t!="string")return i.EMPTY_STRING;let a=0,l="",d=!1,p=!1,g=1,y=!1,s=t,f=n;s.slice(0,this.prefix.length)===this.prefix&&(s=s.slice(this.prefix.length,s.length)),this.suffix&&s.length>0&&(s=this.checkAndRemoveSuffix(s)),s==="("&&this.prefix&&(s="");let M=s.toString().split(i.EMPTY_STRING);if(this.allowNegativeNumbers&&s.slice(a,a+1)===i.MINUS&&(l+=s.slice(a,a+1)),e===i.IP){let m=s.split(i.DOT);this.ipError=this._validIP(m),e="099.099.099.099"}let E=[];for(let m=0;m<s.length;m++)s[m]?.match("\\d")&&E.push(s[m]??i.EMPTY_STRING);if(e===i.CPF_CNPJ&&(this.cpfCnpjError=E.length!==11&&E.length!==14,E.length>11?e="00.000.000/0000-00":e="000.000.000-00"),e.startsWith(i.PERCENT)){if(s.match("[a-z]|[A-Z]")||s.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!o){s=this._stripToDecimal(s);let V=this.getPrecision(e);s=this.checkInputPrecision(s,V,this.decimalMarker)}let m=typeof this.decimalMarker=="string"?this.decimalMarker:i.DOT;if(s.indexOf(m)>0&&!this.percentage(s.substring(0,s.indexOf(m)))){let V=s.substring(0,s.indexOf(m)-1);this.allowNegativeNumbers&&s.slice(a,a+1)===i.MINUS&&!o&&(V=s.substring(0,s.indexOf(m))),s=`${V}${s.substring(s.indexOf(m),s.length)}`}let h="";this.allowNegativeNumbers&&s.slice(a,a+1)===i.MINUS?h=`${i.MINUS}${s.slice(a+1,a+s.length)}`:h=s,this.percentage(h)?l=this._splitPercentZero(s):l=this._splitPercentZero(s.substring(0,s.length-1))}else if(e.startsWith(i.SEPARATOR)){(s.match("[w\u0430-\u044F\u0410-\u042F]")||s.match("[\u0401\u0451\u0410-\u044F]")||s.match("[a-z]|[A-Z]")||s.match(/[-@#!$%\\^&*()_£¬'+|~=`{}\]:";<>.?/]/)||s.match("[^A-Za-z0-9,]"))&&(s=this._stripToDecimal(s));let m=this.getPrecision(e),h=this.decimalMarker;if(Array.isArray(this.decimalMarker)&&(this.actualValue.includes(this.decimalMarker[0])||this.actualValue.includes(this.decimalMarker[1])?h=this.actualValue.includes(this.decimalMarker[0])?this.decimalMarker[0]:this.decimalMarker[1]:h=this.decimalMarker.find(_=>_!==this.thousandSeparator)),o){let{decimalMarkerIndex:_,nonZeroIndex:S}=this._findFirstNonZeroAndDecimalIndex(s,h),T=s[0]===i.MINUS,$=s[0]===i.NUMBER_ZERO,U=s[0]===h,H=s[1]===h;(U&&!S||T&&H&&!S||$&&!_&&!S)&&(s=i.NUMBER_ZERO),_&&S&&T&&f===1&&(_<S||_>S)&&(s=i.MINUS+s.slice(S)),!_&&S&&s.length>S&&(s=T?i.MINUS+s.slice(S):s.slice(S)),_&&S&&f===0&&(_<S&&(s=s.slice(_-1)),_>S&&(s=s.slice(S)))}m===0?s=this.allowNegativeNumbers?s.length>2&&s[0]===i.MINUS&&s[1]===i.NUMBER_ZERO&&s[2]!==this.thousandSeparator&&s[2]!==i.COMMA&&s[2]!==i.DOT?"-"+s.slice(2,s.length):s[0]===i.NUMBER_ZERO&&s.length>1&&s[1]!==this.thousandSeparator&&s[1]!==i.COMMA&&s[1]!==i.DOT?s.slice(1,s.length):s:s.length>1&&s[0]===i.NUMBER_ZERO&&s[1]!==this.thousandSeparator&&s[1]!==i.COMMA&&s[1]!==i.DOT?s.slice(1,s.length):s:(s[0]===h&&s.length>1&&!o&&(s=i.NUMBER_ZERO+s.slice(0,s.length+1),this.plusOnePosition=!0),s[0]===i.NUMBER_ZERO&&s[1]!==h&&s[1]!==this.thousandSeparator&&!o&&(s=s.length>1?s.slice(0,1)+h+s.slice(1,s.length+1):s,this.plusOnePosition=!0),this.allowNegativeNumbers&&!o&&s[0]===i.MINUS&&(s[1]===h||s[1]===i.NUMBER_ZERO)&&(s=s[1]===h&&s.length>2?s.slice(0,1)+i.NUMBER_ZERO+s.slice(1,s.length):s[1]===i.NUMBER_ZERO&&s.length>2&&s[2]!==h?s.slice(0,2)+h+s.slice(2,s.length):s,this.plusOnePosition=!0));let V=this._charToRegExpExpression(this.thousandSeparator),C='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(V,"");if(Array.isArray(this.decimalMarker))for(let _ of this.decimalMarker)C=C.replace(this._charToRegExpExpression(_),i.EMPTY_STRING);else C=C.replace(this._charToRegExpExpression(this.decimalMarker),"");let k=new RegExp("["+C+"]");s.match(k)&&(s=s.substring(0,s.length-1)),s=this.checkInputPrecision(s,m,this.decimalMarker);let N=s.replace(new RegExp(V,"g"),"");l=this._formatWithSeparators(N,this.thousandSeparator,this.decimalMarker,m);let j=l.indexOf(i.COMMA)-s.indexOf(i.COMMA),D=l.length-s.length,G=o&&l.length<t.length&&this.separatorLimit;if((l[f-1]===this.thousandSeparator||l[f-this.prefix.length])&&this.prefix&&o)f=f-1;else if(D>0&&l[f]!==this.thousandSeparator||G){p=!0;let _=0;do this._shift.add(f+_),_++;while(_<D)}else l[f-1]===this.thousandSeparator||D===-4||D===-3||l[f]===this.thousandSeparator?(this._shift.clear(),this._shift.add(f-1)):j!==0&&f>0&&!(l.indexOf(i.COMMA)>=f&&f>3)||!(l.indexOf(i.DOT)>=f&&f>3)&&D<=0?(this._shift.clear(),p=!0,g=D,f+=D,this._shift.add(f)):this._shift.clear()}else for(let m=0,h=M[0];m<M.length&&a!==e.length;m++,h=M[m]??i.EMPTY_STRING){let V=i.SYMBOL_STAR in this.patterns;if(this._checkSymbolMask(h,e[a]??i.EMPTY_STRING)&&e[a+1]===i.SYMBOL_QUESTION)l+=h,a+=2;else if(e[a+1]===i.SYMBOL_STAR&&d&&this._checkSymbolMask(h,e[a+2]??i.EMPTY_STRING))l+=h,a+=3,d=!1;else if(this._checkSymbolMask(h,e[a]??i.EMPTY_STRING)&&e[a+1]===i.SYMBOL_STAR&&!V)l+=h,d=!0;else if(e[a+1]===i.SYMBOL_QUESTION&&this._checkSymbolMask(h,e[a+2]??i.EMPTY_STRING))l+=h,a+=3;else if(this._checkSymbolMask(h,e[a]??i.EMPTY_STRING)){if(e[a]===i.HOURS&&(this.apm?Number(h)>9:Number(h)>2)){f=this.leadZeroDateTime?f:f+1,a+=1,this._shiftStep(a),m--,this.leadZeroDateTime&&(l+="0");continue}if(e[a]===i.HOUR&&(this.apm?l.length===1&&Number(l)>1||l==="1"&&Number(h)>2||s.slice(a-1,a).length===1&&Number(s.slice(a-1,a))>2||s.slice(a-1,a)==="1"&&Number(h)>2:l==="2"&&Number(h)>3||(l.slice(a-2,a)==="2"||l.slice(a-3,a)==="2"||l.slice(a-4,a)==="2"||l.slice(a-1,a)==="2")&&Number(h)>3&&a>10)){f=f+1,a+=1,m--;continue}if((e[a]===i.MINUTE||e[a]===i.SECOND)&&Number(h)>5){f=this.leadZeroDateTime?f:f+1,a+=1,this._shiftStep(a),m--,this.leadZeroDateTime&&(l+="0");continue}let C=31,k=s[a],N=s[a+1],j=s[a+2],D=s[a-1],G=s[a-2],_=s.slice(a-3,a-1),S=s.slice(a-1,a+1),T=s.slice(a,a+2),$=s.slice(a-2,a);if(e[a]===i.DAY){let U=e.slice(0,2)===i.MONTHS,H=e.slice(0,2)===i.MONTHS&&this.specialCharacters.includes(G);if(Number(h)>3&&this.leadZeroDateTime||!U&&(Number(T)>C||Number(S)>C||this.specialCharacters.includes(N))||(H?Number(S)>C||!this.specialCharacters.includes(k)&&this.specialCharacters.includes(j)||this.specialCharacters.includes(k):Number(T)>C||this.specialCharacters.includes(N)&&!o)){f=this.leadZeroDateTime?f:f+1,a+=1,this._shiftStep(a),m--,this.leadZeroDateTime&&(l+="0");continue}}if(e[a]===i.MONTH){let H=a===0&&(Number(h)>2||Number(T)>12||this.specialCharacters.includes(N)&&!o),he=e.slice(a+2,a+3),ue=_.includes(he)&&e.includes("d0")&&(this.specialCharacters.includes(G)&&Number(S)>12&&!this.specialCharacters.includes(k)||this.specialCharacters.includes(k)),de=Number(_)<=C&&!this.specialCharacters.includes(_)&&this.specialCharacters.includes(D)&&(Number(T)>12||this.specialCharacters.includes(N)),fe=Number(T)>12&&a===5||this.specialCharacters.includes(N)&&a===5,pe=Number(_)>C&&!this.specialCharacters.includes(_)&&!this.specialCharacters.includes($)&&Number($)>12&&e.includes("d0"),me=Number(_)<=C&&!this.specialCharacters.includes(_)&&!this.specialCharacters.includes(D)&&Number(S)>12;if(Number(h)>1&&this.leadZeroDateTime||H||ue||me||pe||de||fe&&!this.leadZeroDateTime){f=this.leadZeroDateTime?f:f+1,a+=1,this._shiftStep(a),m--,this.leadZeroDateTime&&(l+="0");continue}}l+=h,a++}else this.specialCharacters.includes(h)&&e[a]===h?(l+=h,a++):this.specialCharacters.indexOf(e[a]??i.EMPTY_STRING)!==-1?(l+=e[a],a++,this._shiftStep(a),m--):e[a]===i.NUMBER_NINE&&this.showMaskTyped?this._shiftStep(a):this.patterns[e[a]??i.EMPTY_STRING]&&this.patterns[e[a]??i.EMPTY_STRING]?.optional?(M[a]&&e!=="099.099.099.099"&&e!=="000.000.000-00"&&e!=="00.000.000/0000-00"&&!e.match(/^9+\.0+$/)&&!this.patterns[e[a]??i.EMPTY_STRING]?.optional&&(l+=M[a]),e.includes(i.NUMBER_NINE+i.SYMBOL_STAR)&&e.includes(i.NUMBER_ZERO+i.SYMBOL_STAR)&&a++,a++,m--):this.maskExpression[a+1]===i.SYMBOL_STAR&&this._findSpecialChar(this.maskExpression[a+2]??i.EMPTY_STRING)&&this._findSpecialChar(h)===this.maskExpression[a+2]&&d||this.maskExpression[a+1]===i.SYMBOL_QUESTION&&this._findSpecialChar(this.maskExpression[a+2]??i.EMPTY_STRING)&&this._findSpecialChar(h)===this.maskExpression[a+2]&&d?(a+=3,l+=h):this.showMaskTyped&&this.specialCharacters.indexOf(h)<0&&h!==this.placeHolderCharacter&&this.placeHolderCharacter.length===1&&(y=!0)}l[f-1]&&l.length+1===e.length&&this.specialCharacters.indexOf(e[e.length-1]??i.EMPTY_STRING)!==-1&&(l+=e[e.length-1]);let I=f+1;for(;this._shift.has(I);)g++,I++;let w=r&&!e.startsWith(i.SEPARATOR)?a:this._shift.has(f)?g:0;y&&w--,u(w,p),g<0&&this._shift.clear();let R=!1;o&&(R=M.every(m=>this.specialCharacters.includes(m)));let x=`${this.prefix}${R?i.EMPTY_STRING:l}${this.showMaskTyped?"":this.suffix}`;l.length===0&&(x=this.instantPrefix?`${this.prefix}${l}`:`${l}`);let F=s.length===1&&this.specialCharacters.includes(e[0])&&s!==e[0];if(!this._checkSymbolMask(s,e[1])&&F)return"";if(l.includes(i.MINUS)&&this.prefix&&this.allowNegativeNumbers){if(o&&l===i.MINUS)return"";x=`${i.MINUS}${this.prefix}${l.split(i.MINUS).join(i.EMPTY_STRING)}${this.suffix}`}return x}_findDropSpecialChar(t){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find(e=>e===t):this._findSpecialChar(t)}_findSpecialChar(t){return this.specialCharacters.find(e=>e===t)}_checkSymbolMask(t,e){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[e]?.pattern&&this.patterns[e]?.pattern.test(t))??!1}_formatWithSeparators=(t,e,n,r)=>{let o=[],u="";if(Array.isArray(n)){let g=new RegExp(n.map(y=>"[\\^$.|?*+()".indexOf(y)>=0?`\\${y}`:y).join("|"));o=t.split(g),u=t.match(g)?.[0]??i.EMPTY_STRING}else o=t.split(n),u=n;let a=o.length>1?`${u}${o[1]}`:i.EMPTY_STRING,l=o[0]??i.EMPTY_STRING,d=this.separatorLimit.replace(/\s/g,i.EMPTY_STRING);d&&+d&&(l[0]===i.MINUS?l=`-${l.slice(1,l.length).slice(0,d.length)}`:l=l.slice(0,d.length));let p=/(\d+)(\d{3})/;for(;e&&p.test(l);)l=l.replace(p,"$1"+e+"$2");return typeof r>"u"?l+a:r===0?l:l+a.substring(0,r+1)};percentage=t=>{let e=t.replace(",","."),n=Number(this.allowNegativeNumbers&&t.includes(i.MINUS)?e.slice(1,t.length):e);return!isNaN(n)&&n>=0&&n<=100};getPrecision=t=>{let e=t.split(i.DOT);return e.length>1?Number(e[e.length-1]):1/0};checkAndRemoveSuffix=t=>{for(let e=this.suffix?.length-1;e>=0;e--){let n=this.suffix.substring(e,this.suffix?.length);if(t.includes(n)&&e!==this.suffix?.length-1&&(e-1<0||!t.includes(this.suffix.substring(e-1,this.suffix?.length))))return t.replace(n,i.EMPTY_STRING)}return t};checkInputPrecision=(t,e,n)=>{let r=t,o=n;if(e<1/0){if(Array.isArray(o)){let d=o.find(p=>p!==this.thousandSeparator);o=d||o[0]}let u=new RegExp(this._charToRegExpExpression(o)+`\\d{${e}}.*$`),a=r.match(u),l=(a&&a[0]?.length)??0;if(l-1>e){let d=l-1-e;r=r.substring(0,r.length-d)}e===0&&this._compareOrIncludes(r[r.length-1],o,this.thousandSeparator)&&(r=r.substring(0,r.length-1))}return r};_stripToDecimal(t){return t.split(i.EMPTY_STRING).filter((e,n)=>{let r=typeof this.decimalMarker=="string"?e===this.decimalMarker:this.decimalMarker.includes(e);return e.match("^-?\\d")||e===this.thousandSeparator||r||e===i.MINUS&&n===0&&this.allowNegativeNumbers}).join(i.EMPTY_STRING)}_charToRegExpExpression(t){return t&&(t===" "?"\\s":"[\\^$.|?*+()".indexOf(t)>=0?`\\${t}`:t)}_shiftStep(t){this._shift.add(t+this.prefix.length||0)}_compareOrIncludes(t,e,n){return Array.isArray(e)?e.filter(r=>r!==n).includes(t):t===e}_validIP(t){return!(t.length===4&&!t.some((e,n)=>t.length!==n+1?e===i.EMPTY_STRING||Number(e)>255:e===i.EMPTY_STRING||Number(e.substring(0,3))>255))}_splitPercentZero(t){if(t===i.MINUS&&this.allowNegativeNumbers)return t;let e=typeof this.decimalMarker=="string"?t.indexOf(this.decimalMarker):t.indexOf(i.DOT),n=this.allowNegativeNumbers&&t.includes(i.MINUS)?"-":"";if(e===-1){let r=parseInt(n?t.slice(1,t.length):t,10);return isNaN(r)?i.EMPTY_STRING:`${n}${r}`}else{let r=parseInt(t.replace("-","").substring(0,e),10),o=t.substring(e+1),u=isNaN(r)?"":r.toString(),a=typeof this.decimalMarker=="string"?this.decimalMarker:i.DOT;return u===i.EMPTY_STRING?i.EMPTY_STRING:`${n}${u}${a}${o}`}}_findFirstNonZeroAndDecimalIndex(t,e){let n=null,r=null;for(let o=0;o<t.length;o++){let u=t[o];if(u===e&&n===null&&(n=o),u&&u>="1"&&u<="9"&&r===null&&(r=o),n!==null&&r!==null)break}return{decimalMarkerIndex:n,nonZeroIndex:r}}static \u0275fac=function(e){return new(e||c)};static \u0275prov=Z({token:c,factory:c.\u0275fac})}return c})(),q=(()=>{class c extends ye{isNumberValue=!1;maskIsShown="";selStart=null;selEnd=null;maskChanged=!1;maskExpressionArray=[];previousValue="";currentValue="";writingValue=!1;_emitValue=!1;_start;_end;onChange=t=>{};_elementRef=A(te,{optional:!0});document=A(K);_config=A(B);_renderer=A(ie,{optional:!0});applyMask(t,e,n=0,r=!1,o=!1,u=()=>{}){if(!e)return t!==this.actualValue?this.actualValue:t;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():i.EMPTY_STRING,this.maskExpression===i.IP&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),this.maskExpression===i.CPF_CNPJ&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),!t&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;let a=t&&typeof this.selStart=="number"?t[this.selStart]??i.EMPTY_STRING:i.EMPTY_STRING,l="",d=n;if((this.hiddenInput||t&&t.indexOf(i.SYMBOL_STAR)>=0)&&!this.writingValue){let s=t&&t.length===1?t.split(i.EMPTY_STRING):this.actualValue.split(i.EMPTY_STRING);o&&(s=s.slice(0,n).concat(s.slice(n+1))),this.showMaskTyped&&(t=this.removeMask(t),s=this.removeMask(s.join("")).split(i.EMPTY_STRING)),typeof this.selStart=="object"&&typeof this.selEnd=="object"?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):t!==i.EMPTY_STRING&&s.length?typeof this.selStart=="number"&&typeof this.selEnd=="number"&&(t.length>s.length?s.splice(this.selStart,0,a):t.length<s.length&&(s.length-t.length===1?o?s.splice(this.selStart-1,1):s.splice(t.length-1,1):s.splice(this.selStart,this.selEnd-this.selStart))):s=[],this.showMaskTyped&&!this.hiddenInput&&(l=this.removeMask(t)),this.actualValue.length?s.length<t.length?l=this.shiftTypedSymbols(s.join(i.EMPTY_STRING)):s.length===t.length?l=s.join(i.EMPTY_STRING):l=t:l=t}if(r&&(this.hiddenInput||!this.hiddenInput)&&(l=t),o&&this.specialCharacters.indexOf(this.maskExpression[d]??i.EMPTY_STRING)!==-1&&this.showMaskTyped&&!this.prefix&&(l=this.currentValue),this.deletedSpecialCharacter&&d&&(this.specialCharacters.includes(this.actualValue.slice(d,d+1))?d=d+1:e.slice(d-1,d+1)!==i.MONTHS&&(d=d-2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&this.placeHolderCharacter.length===1&&!this.leadZeroDateTime&&(l=this.removeMask(l)),this.maskChanged?l=t:l=l&&l.length?l:t,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!r&&!this.writingValue){let s=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(s),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}let p=super.applyMask(l,e,d,r,o,u);if(this.actualValue=this.getActualValue(p),this.thousandSeparator===i.DOT&&this.decimalMarker===i.DOT&&(this.decimalMarker=i.COMMA),this.maskExpression.startsWith(i.SEPARATOR)&&this.dropSpecialCharacters===!0&&(this.specialCharacters=this.specialCharacters.filter(s=>!this._compareOrIncludes(s,this.decimalMarker,this.thousandSeparator))),(p||p==="")&&(this.previousValue=this.currentValue,this.currentValue=p,this._emitValue=this.previousValue!==this.currentValue||l!==this.currentValue&&this.writingValue||this.previousValue===this.currentValue&&r),this._emitValue&&this.formControlResult(p),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?`${this.hideInput(p,this.maskExpression)}${this.maskIsShown.slice(p.length)}`:p;let g=p.length,y=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes(i.HOURS)){let s=this._numberSkipedSymbols(p);return`${p}${y.slice(g+s)}`}else if(this.maskExpression===i.IP||this.maskExpression===i.CPF_CNPJ)return`${p}${y}`;return`${p}${y.slice(g)}`}_numberSkipedSymbols(t){let e=/(^|\D)(\d\D)/g,n=e.exec(t),r=0;for(;n!=null;)r+=1,n=e.exec(t);return r}applyValueChanges(t,e,n,r=()=>{}){let o=this._elementRef?.nativeElement;o&&(o.value=this.applyMask(o.value,this.maskExpression,t,e,n,r),o!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(t,e){return t.split(i.EMPTY_STRING).map((n,r)=>this.patterns&&this.patterns[e[r]??i.EMPTY_STRING]&&this.patterns[e[r]??i.EMPTY_STRING]?.symbol?this.patterns[e[r]??i.EMPTY_STRING]?.symbol:n).join(i.EMPTY_STRING)}getActualValue(t){let e=t.split(i.EMPTY_STRING).filter((n,r)=>{let o=this.maskExpression[r]??i.EMPTY_STRING;return this._checkSymbolMask(n,o)||this.specialCharacters.includes(o)&&n===o});return e.join(i.EMPTY_STRING)===t?e.join(i.EMPTY_STRING):t}shiftTypedSymbols(t){let e="";return(t&&t.split(i.EMPTY_STRING).map((r,o)=>{if(this.specialCharacters.includes(t[o+1]??i.EMPTY_STRING)&&t[o+1]!==this.maskExpression[o+1])return e=r,t[o+1];if(e.length){let u=e;return e=i.EMPTY_STRING,u}return r})||[]).join(i.EMPTY_STRING)}numberToString(t){return!t&&t!==0||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith(i.SEPARATOR)&&this.separatorLimit.length>14&&String(t).length>14?String(t):Number(t).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace(`/${i.MINUS}/`,i.MINUS)}showMaskInInput(t){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}else if(this.showMaskTyped){if(t){if(this.maskExpression===i.IP)return this._checkForIp(t);if(this.maskExpression===i.CPF_CNPJ)return this._checkForCpfCnpj(t)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){let t=this._elementRef?.nativeElement;t&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==t.value.replace(this.placeHolderCharacter,i.EMPTY_STRING).length&&(this.formElementProperty=["value",i.EMPTY_STRING],this.applyMask("",this.maskExpression))}set formElementProperty([t,e]){!this._renderer||!this._elementRef||Promise.resolve().then(()=>this._renderer?.setProperty(this._elementRef?.nativeElement,t,e))}checkDropSpecialCharAmount(t){return t.split(i.EMPTY_STRING).filter(n=>this._findDropSpecialChar(n)).length}removeMask(t){return this._removeMask(this._removeSuffix(this._removePrefix(t)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(t){if(t===i.HASH)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;let e=[];for(let n=0;n<t.length;n++){let r=t[n]??i.EMPTY_STRING;r&&r.match("\\d")&&e.push(r)}return e.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>3&&e.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>6&&e.length<=9?this.placeHolderCharacter:(e.length>9&&e.length<=12,"")}_checkForCpfCnpj(t){let e=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,n=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if(t===i.HASH)return e;let r=[];for(let o=0;o<t.length;o++){let u=t[o]??i.EMPTY_STRING;u&&u.match("\\d")&&r.push(u)}return r.length<=3?e.slice(r.length,e.length):r.length>3&&r.length<=6?e.slice(r.length+1,e.length):r.length>6&&r.length<=9?e.slice(r.length+2,e.length):r.length>9&&r.length<11?e.slice(r.length+3,e.length):r.length===11?"":r.length===12?t.length===17?n.slice(16,n.length):n.slice(15,n.length):r.length>12&&r.length<=14?n.slice(r.length+4,n.length):""}_getActiveElement(t=this.document){let e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}formControlResult(t){let e=this.outputTransformFn?this.outputTransformFn:n=>n;this.writingValue=!1,this.maskChanged=!1,Array.isArray(this.dropSpecialCharacters)?this.onChange(e(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(t)),this.dropSpecialCharacters))))):this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===t?this.onChange(e(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(t)))))):this.onChange(e(this._toNumber(t)))}_toNumber(t){if(!this.isNumberValue||t===i.EMPTY_STRING||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters))return t;if(String(t).length>14&&this.maskExpression.startsWith(i.SEPARATOR))return String(t);let e=Number(t);if(this.maskExpression.startsWith(i.SEPARATOR)&&Number.isNaN(e)){let n=String(t).replace(",",".");return Number(n)}return Number.isNaN(e)?t:e}_removeMask(t,e){return this.maskExpression.startsWith(i.PERCENT)&&t.includes(i.DOT)?t:t&&t.replace(this._regExpForRemove(e),i.EMPTY_STRING)}_removePrefix(t){return this.prefix?t&&t.replace(this.prefix,i.EMPTY_STRING):t}_removeSuffix(t){return this.suffix?t&&t.replace(this.suffix,i.EMPTY_STRING):t}_retrieveSeparatorValue(t){let e=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter(n=>this.dropSpecialCharacters.includes(n)):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&t.includes(i.WHITE_SPACE)&&this.maskExpression.includes(i.SYMBOL_STAR)&&(e=e.filter(n=>n!==i.WHITE_SPACE)),this._removeMask(t,e)}_regExpForRemove(t){return new RegExp(t.map(e=>`\\${e}`).join("|"),"gi")}_replaceDecimalMarkerToDot(t){let e=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return t.replace(this._regExpForRemove(e),i.DOT)}_checkSymbols(t){let e=t;if(e===i.EMPTY_STRING)return e;this.maskExpression.startsWith(i.PERCENT)&&this.decimalMarker===i.COMMA&&(e=e.replace(i.COMMA,i.DOT));let n=this._retrieveSeparatorPrecision(this.maskExpression),r=this.specialCharacters.length===0?this._retrieveSeparatorValue(e):this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(e));return this.isNumberValue&&n?e===this.decimalMarker?null:r.length>14?String(r):this._checkPrecision(this.maskExpression,r):r}_checkPatternForSpace(){for(let t in this.patterns)if(this.patterns[t]&&this.patterns[t]?.hasOwnProperty("pattern")){let e=this.patterns[t]?.pattern.toString(),n=this.patterns[t]?.pattern;if(e?.includes(i.WHITE_SPACE)&&n?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(t){let e=t.match(new RegExp("^separator\\.([^d]*)"));return e?Number(e[1]):null}_checkPrecision(t,e){let n=this.getPrecision(t),r=e;return t.indexOf("2")>0||this.leadZero&&Number(n)>0?(this.decimalMarker===i.COMMA&&this.leadZero&&(r=r.replace(",",".")),this.leadZero?Number(r).toFixed(Number(n)):Number(r).toFixed(2)):this.numberToString(r)}_repeatPatternSymbols(t){return t.match(/{[0-9]+}/)&&t.split(i.EMPTY_STRING).reduce((e,n,r)=>{if(this._start=n===i.CURLY_BRACKETS_LEFT?r:this._start,n!==i.CURLY_BRACKETS_RIGHT)return this._findSpecialChar(n)?e+n:e;this._end=r;let o=Number(t.slice(this._start+1,this._end)),u=new Array(o+1).join(t[this._start-1]);if(t.slice(0,this._start).length>1&&t.includes(i.LETTER_S)){let a=t.slice(0,this._start-1);return a.includes(i.CURLY_BRACKETS_LEFT)?e+u:a+e+u}else return e+u},"")||t}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static \u0275fac=(()=>{let t;return function(n){return(t||(t=X(c)))(n||c)}})();static \u0275prov=Z({token:c,factory:c.\u0275fac})}return c})();function Ce(){let c=A(ce),L=A(le);return L instanceof Function?O(O({},c),L()):O(O({},c),L)}function Me(c){return[{provide:le,useValue:c},{provide:ce,useValue:_e},{provide:B,useFactory:Ce},q]}function it(c){return Q(Me(c))}var rt=(()=>{class c{mask=v("");specialCharacters=v([]);patterns=v({});prefix=v("");suffix=v("");thousandSeparator=v(" ");decimalMarker=v(".");dropSpecialCharacters=v(null);hiddenInput=v(null);showMaskTyped=v(null);placeHolderCharacter=v(null);shownMaskExpression=v(null);clearIfNotMatch=v(null);validation=v(null);separatorLimit=v("");allowNegativeNumbers=v(null);leadZeroDateTime=v(null);leadZero=v(null);triggerOnMaskChange=v(null);apm=v(null);inputTransformFn=v(null);outputTransformFn=v(null);keepCharacterPositions=v(null);instantPrefix=v(null);maskFilled=ee();_maskValue=b("");_inputValue=b("");_position=b(null);_code=b("");_maskExpressionArray=b([]);_justPasted=b(!1);_isFocused=b(!1);_isComposing=b(!1);_maskService=A(q,{self:!0});document=A(K);_config=A(B);onChange=t=>{};onTouch=()=>{};ngOnChanges(t){let{mask:e,specialCharacters:n,patterns:r,prefix:o,suffix:u,thousandSeparator:a,decimalMarker:l,dropSpecialCharacters:d,hiddenInput:p,showMaskTyped:g,placeHolderCharacter:y,shownMaskExpression:s,clearIfNotMatch:f,validation:M,separatorLimit:E,allowNegativeNumbers:I,leadZeroDateTime:w,leadZero:R,triggerOnMaskChange:x,apm:F,inputTransformFn:m,outputTransformFn:h,keepCharacterPositions:V,instantPrefix:C}=t;if(e&&(e.currentValue!==e.previousValue&&!e.firstChange&&(this._maskService.maskChanged=!0),e.currentValue&&e.currentValue.split(i.OR).length>1?(this._maskExpressionArray.set(e.currentValue.split(i.OR).sort((k,N)=>k.length-N.length)),this._setMask()):(this._maskExpressionArray.set([]),this._maskValue.set(e.currentValue||i.EMPTY_STRING),this._maskService.maskExpression=this._maskValue())),n){if(!n.currentValue||!Array.isArray(n.currentValue))return;this._maskService.specialCharacters=n.currentValue||[]}if(I&&(this._maskService.allowNegativeNumbers=I.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.specialCharacters=this._maskService.specialCharacters.filter(k=>k!==i.MINUS))),r&&r.currentValue&&(this._maskService.patterns=r.currentValue),F&&F.currentValue&&(this._maskService.apm=F.currentValue),C&&(this._maskService.instantPrefix=C.currentValue),o&&(this._maskService.prefix=o.currentValue),u&&(this._maskService.suffix=u.currentValue),a&&(this._maskService.thousandSeparator=a.currentValue,a.previousValue&&a.currentValue)){let k=this._maskService.decimalMarker;a.currentValue===this._maskService.decimalMarker&&(this._maskService.decimalMarker=a.currentValue===i.COMMA?i.DOT:i.COMMA),this._maskService.dropSpecialCharacters===!0&&(this._maskService.specialCharacters=this._config.specialCharacters),typeof k=="string"&&typeof this._maskService.decimalMarker=="string"&&(this._inputValue.set(this._inputValue().split(a.previousValue).join("").replace(k,this._maskService.decimalMarker)),this._maskService.actualValue=this._inputValue()),this._maskService.writingValue=!0}l&&(this._maskService.decimalMarker=l.currentValue),d&&(this._maskService.dropSpecialCharacters=d.currentValue),p&&(this._maskService.hiddenInput=p.currentValue,p.previousValue===!0&&p.currentValue===!1&&this._inputValue.set(this._maskService.actualValue)),g&&(this._maskService.showMaskTyped=g.currentValue,g.previousValue===!1&&g.currentValue===!0&&this._isFocused()&&requestAnimationFrame(()=>{this._maskService._elementRef?.nativeElement.click()})),y&&(this._maskService.placeHolderCharacter=y.currentValue),s&&(this._maskService.shownMaskExpression=s.currentValue),f&&(this._maskService.clearIfNotMatch=f.currentValue),M&&(this._maskService.validation=M.currentValue),E&&(this._maskService.separatorLimit=E.currentValue),w&&(this._maskService.leadZeroDateTime=w.currentValue),R&&(this._maskService.leadZero=R.currentValue),x&&(this._maskService.triggerOnMaskChange=x.currentValue),m&&(this._maskService.inputTransformFn=m.currentValue),h&&(this._maskService.outputTransformFn=h.currentValue),V&&(this._maskService.keepCharacterPositions=V.currentValue),this._applyMask()}validate({value:t}){let e=typeof t=="number"?String(t):t,n=this._maskValue();if(!this._maskService.validation||!n)return null;if(this._maskService.ipError)return this._createValidationError(e);if(this._maskService.cpfCnpjError)return this._createValidationError(e);if(n.startsWith(i.SEPARATOR)||Se.includes(n)||this._maskService.clearIfNotMatch)return null;if(ve.includes(n))return this._validateTime(e);if(n===i.EMAIL_MASK)return!/^[^@]+@[^@]+\.[^@]+$/.test(e)&&e?this._createValidationError(e):null;if(e&&e.length>=1){let r=0;if(n.includes(i.CURLY_BRACKETS_LEFT)&&n.includes(i.CURLY_BRACKETS_RIGHT))return n.slice(n.indexOf(i.CURLY_BRACKETS_LEFT)+1,n.indexOf(i.CURLY_BRACKETS_RIGHT))===String(e.length)?null:this._createValidationError(e);if(n.startsWith(i.PERCENT))return null;for(let o in this._maskService.patterns)if(this._maskService.patterns[o]?.optional){if(n.indexOf(o)!==n.lastIndexOf(o)){let u=n.split(i.EMPTY_STRING).filter(a=>a===o).join(i.EMPTY_STRING);r+=u.length}else n.indexOf(o)!==-1&&r++;if(n.indexOf(o)!==-1&&e.length>=n.indexOf(o)||r===n.length)return null}if(n.indexOf(i.SYMBOL_STAR)>1&&e.length<n.indexOf(i.SYMBOL_STAR)||n.indexOf(i.SYMBOL_QUESTION)>1&&e.length<n.indexOf(i.SYMBOL_QUESTION))return this._createValidationError(e);if(n.indexOf(i.SYMBOL_STAR)===-1||n.indexOf(i.SYMBOL_QUESTION)===-1){let o=n.split("*"),u=this._maskService.dropSpecialCharacters?n.length-this._maskService.checkDropSpecialCharAmount(n)-r:this.prefix()?n.length+this.prefix().length-r:n.length-r;if(o.length===1&&e.length<u)return this._createValidationError(e);if(o.length>1){let a=o[o.length-1];if(a&&this._maskService.specialCharacters.includes(a[0])&&String(e).includes(a[0]??"")&&!this.dropSpecialCharacters()){let l=t.split(a[0]);return l[l.length-1].length===a.length-1?null:this._createValidationError(e)}else return(a&&!this._maskService.specialCharacters.includes(a[0])||!a||this._maskService.dropSpecialCharacters)&&e.length>=u-1?null:this._createValidationError(e)}}if(n.indexOf(i.SYMBOL_STAR)===1||n.indexOf(i.SYMBOL_QUESTION)===1)return null}return t&&this.maskFilled.emit(),null}onPaste(){this._justPasted.set(!0)}onFocus(){this._isFocused.set(!0)}onModelChange(t){(t===i.EMPTY_STRING||t===null||typeof t>"u")&&this._maskService.actualValue&&(this._maskService.actualValue=this._maskService.getActualValue(i.EMPTY_STRING))}onInput(t){if(this._isComposing())return;let e=t.target,n=this._maskService.inputTransformFn?this._maskService.inputTransformFn(e.value):e.value;if(e.type!=="number")if(typeof n=="string"||typeof n=="number"){if(e.value=n.toString(),this._inputValue.set(e.value),this._setMask(),!this._maskValue()){this.onChange(e.value);return}let r=e.selectionStart===1?e.selectionStart+this._maskService.prefix.length:e.selectionStart;if(this.showMaskTyped()&&this.keepCharacterPositions()&&this._maskService.placeHolderCharacter.length===1){let l=this.suffix(),d=this.prefix(),p=e.value.slice(r-1,r),g=d.length,y=this._maskService._checkSymbolMask(p,this._maskService.maskExpression[r-1-g]??i.EMPTY_STRING),s=this._maskService._checkSymbolMask(p,this._maskService.maskExpression[r+1-g]??i.EMPTY_STRING),f=this._maskService.selStart===this._maskService.selEnd,M=Number(this._maskService.selStart)-g,E=Number(this._maskService.selEnd)-g,I=this._code()===i.BACKSPACE||this._code()===i.DELETE;if(I){if(!f)this._maskService.selStart===g?this._maskService.actualValue=`${d}${this._maskService.maskIsShown.slice(0,E)}${this._inputValue().split(d).join("")}`:this._maskService.selStart===this._maskService.maskIsShown.length+g?this._maskService.actualValue=`${this._inputValue()}${this._maskService.maskIsShown.slice(M,E)}`:this._maskService.actualValue=`${d}${this._inputValue().split(d).join("").slice(0,M)}${this._maskService.maskIsShown.slice(M,E)}${this._maskService.actualValue.slice(E+g,this._maskService.maskIsShown.length+g)}${l}`;else if(!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(r-g,r+1-g))&&f)if(M===1&&d)this._maskService.actualValue=`${d}${this._maskService.placeHolderCharacter}${e.value.split(d).join("").split(l).join("")}${l}`,r=r-1;else{let w=e.value.substring(0,r),R=e.value.substring(r);this._maskService.actualValue=`${w}${this._maskService.placeHolderCharacter}${R}`}r=this._code()===i.DELETE?r+1:r}I||(!y&&!s&&f?r=Number(e.selectionStart)-1:this._maskService.specialCharacters.includes(e.value.slice(r,r+1))&&s&&!this._maskService.specialCharacters.includes(e.value.slice(r+1,r+2))?(this._maskService.actualValue=`${e.value.slice(0,r-1)}${e.value.slice(r,r+1)}${p}${e.value.slice(r+2)}`,r=r+1):y?e.value.length===1&&r===1?this._maskService.actualValue=`${d}${p}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${l}`:this._maskService.actualValue=`${e.value.slice(0,r-1)}${p}${e.value.slice(r+1).split(l).join("")}${l}`:d&&e.value.length===1&&r-g===1&&this._maskService._checkSymbolMask(e.value,this._maskService.maskExpression[r-1-g]??i.EMPTY_STRING)&&(this._maskService.actualValue=`${d}${e.value}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${l}`))}let o=0,u=!1;if(this._code()===i.DELETE&&i.SEPARATOR&&(this._maskService.deletedSpecialCharacter=!0),this._inputValue().length>=this._maskService.maskExpression.length-1&&this._code()!==i.BACKSPACE&&this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&r<10){let l=this._inputValue().slice(r-1,r);e.value=this._inputValue().slice(0,r-1)+l+this._inputValue().slice(r+1)}if(this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&this.leadZeroDateTime()&&(r<3&&Number(e.value)>31&&Number(e.value)<40||r===5&&Number(e.value.slice(3,5))>12)&&(r=r+2),this._maskService.maskExpression===i.HOURS_MINUTES_SECONDS&&this.apm()&&(this._justPasted()&&e.value.slice(0,2)===i.DOUBLE_ZERO&&(e.value=e.value.slice(1,2)+e.value.slice(2,e.value.length)),e.value=e.value===i.DOUBLE_ZERO?i.NUMBER_ZERO:e.value),this._maskService.applyValueChanges(r,this._justPasted(),this._code()===i.BACKSPACE||this._code()===i.DELETE,(l,d)=>{this._justPasted.set(!1),o=l,u=d}),this._getActiveElement()!==e)return;if(this._maskService.plusOnePosition&&(r=r+1,this._maskService.plusOnePosition=!1),this._maskExpressionArray().length)if(this._code()===i.BACKSPACE){let l=this.specialCharacters().includes(this._maskService.actualValue.slice(r-1,r)),d=this._maskService.removeMask(this._inputValue())?.length===this._maskService.removeMask(this._maskService.maskExpression)?.length,p=this.specialCharacters().includes(this._maskService.actualValue.slice(r,r+1));d&&!p?r=e.selectionStart+1:r=l?r-1:r}else r=e.selectionStart===1?e.selectionStart+this._maskService.prefix.length:e.selectionStart;this._position.set(this._position()===1&&this._inputValue().length===1?null:this._position());let a=this._position()?this._inputValue().length+r+o:r+(this._code()===i.BACKSPACE&&!u?0:o);a>this._getActualInputLength()&&(a=e.value===this._maskService.decimalMarker&&e.value.length===1?this._getActualInputLength()+1:this._getActualInputLength()),a<0&&(a=0),e.setSelectionRange(a,a),this._position.set(null)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof n);else{if(!this._maskValue()){this.onChange(e.value);return}this._maskService.applyValueChanges(e.value.length,this._justPasted(),this._code()===i.BACKSPACE||this._code()===i.DELETE)}}onCompositionStart(){this._isComposing.set(!0)}onCompositionEnd(t){this._isComposing.set(!1),this._justPasted.set(!0),this.onInput(t)}onBlur(t){if(this._maskValue()){let e=t.target;if(this._maskService.leadZero&&e.value.length>0&&typeof this._maskService.decimalMarker=="string"){let n=this._maskService.maskExpression,r=this._maskService.decimalMarker,o=this._maskService.suffix,u=Number(this._maskService.maskExpression.slice(n.length-1,n.length));if(u>0){e.value=o?e.value.split(o).join(""):e.value;let a=e.value.split(r)[1];e.value=e.value.includes(r)?e.value+i.NUMBER_ZERO.repeat(u-a.length)+o:e.value+r+i.NUMBER_ZERO.repeat(u)+o,this._maskService.actualValue=e.value}}this._maskService.clearIfNotMatchFn()}this._isFocused.set(!1),this.onTouch()}onClick(t){if(!this._maskValue())return;let e=t.target,n=0,r=0;e!==null&&e.selectionStart!==null&&e.selectionStart===e.selectionEnd&&e.selectionStart>this._maskService.prefix.length&&t.keyCode!==38&&this._maskService.showMaskTyped&&!this.keepCharacterPositions()&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),e.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===e.value?(e.focus(),e.setSelectionRange(n,r)):e.selectionStart>this._maskService.actualValue.length&&e.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));let o=e&&(e.value===this._maskService.prefix?this._maskService.prefix+this._maskService.maskIsShown:e.value);if(e&&e.value!==o&&(e.value=o),e&&e.type!=="number"&&(e.selectionStart||e.selectionEnd)<=this._maskService.prefix.length){let u=this._maskService.maskExpression.match(new RegExp(`^[${this._maskService.specialCharacters.map(a=>`\\${a}`).join("")}]+`))?.[0].length||0;e.selectionStart=this._maskService.prefix.length+u;return}e&&e.selectionEnd>this._getActualInputLength()&&(e.selectionEnd=this._getActualInputLength())}onKeyDown(t){if(!this._maskValue())return;if(this._isComposing()){t.key==="Enter"&&this.onCompositionEnd(t);return}this._code.set(t.code?t.code:t.key);let e=t.target;if(this._inputValue.set(e.value),this._setMask(),e.type!=="number"){if(t.key===i.ARROW_UP&&t.preventDefault(),t.key===i.ARROW_LEFT||t.key===i.BACKSPACE||t.key===i.DELETE){if(t.key===i.BACKSPACE&&e.value.length===0&&(e.selectionStart=e.selectionEnd),t.key===i.BACKSPACE&&e.selectionStart!==0){let r=this.prefix().length,o=this.specialCharacters().length?this.specialCharacters():this._config.specialCharacters;if(r>1&&e.selectionStart<=r)e.setSelectionRange(r,e.selectionEnd);else if(this._inputValue().length!==e.selectionStart&&e.selectionStart!==1)for(;o.includes((this._inputValue()[e.selectionStart-1]??i.EMPTY_STRING).toString())&&(r>=1&&e.selectionStart>r||r===0);)e.setSelectionRange(e.selectionStart-1,e.selectionEnd)}this.checkSelectionOnDeletion(e),this._maskService.prefix.length&&e.selectionStart<=this._maskService.prefix.length&&e.selectionEnd<=this._maskService.prefix.length&&t.preventDefault();let n=e.selectionStart;t.key===i.BACKSPACE&&!e.readOnly&&n===0&&e.selectionEnd===e.value.length&&e.value.length!==0&&(this._position.set(this._maskService.prefix?this._maskService.prefix.length:0),this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position()))}this.suffix()&&this.suffix().length>1&&this._inputValue().length-this.suffix().length<e.selectionStart?e.setSelectionRange(this._inputValue().length-this.suffix().length,this._inputValue().length):(t.code==="KeyA"&&t.ctrlKey||t.code==="KeyA"&&t.metaKey)&&(e.setSelectionRange(0,this._getActualInputLength()),t.preventDefault()),this._maskService.selStart=e.selectionStart,this._maskService.selEnd=e.selectionEnd}}writeValue(t){return z(this,null,function*(){let e=t,n=this._maskService.inputTransformFn;if(typeof e=="object"&&e!==null&&"value"in e&&("disable"in e&&this.setDisabledState(!!e.disable),e=e.value),e!==null&&(e=n?n(e):e),typeof e=="string"||typeof e=="number"||e===null||typeof e>"u"){(e===null||typeof e>"u"||e==="")&&(this._maskService.currentValue="",this._maskService.previousValue="");let r=e;if(typeof r=="number"||this._maskValue().startsWith(i.SEPARATOR)){r=String(r);let o=this._maskService.currentLocaleDecimalMarker();Array.isArray(this._maskService.decimalMarker)||(r=this._maskService.decimalMarker!==o?r.replace(o,this._maskService.decimalMarker):r),this._maskService.leadZero&&r&&this.mask()&&this.dropSpecialCharacters()!==!1&&(r=this._maskService._checkPrecision(this._maskService.maskExpression,r)),(this._maskService.decimalMarker===i.COMMA||Array.isArray(this._maskService.decimalMarker)&&this._maskService.thousandSeparator===i.DOT)&&(r=r.toString().replace(i.DOT,i.COMMA)),this.mask()?.startsWith(i.SEPARATOR)&&this.leadZero()&&requestAnimationFrame(()=>{this._maskService.applyMask(r?.toString()??"",this._maskService.maskExpression)}),this._maskService.isNumberValue=!0}(typeof r!="string"||e===null||typeof e>"u")&&(r=""),this._inputValue.set(r),this._setMask(),r&&this._maskService.maskExpression||this._maskService.maskExpression&&(this._maskService.prefix||this._maskService.showMaskTyped)?(this._maskService.writingValue=!0,this._maskService.formElementProperty=["value",this._maskService.applyMask(r,this._maskService.maskExpression)],this._maskService.writingValue=!1):this._maskService.formElementProperty=["value",r],this._inputValue.set(r)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof e)})}registerOnChange(t){this._maskService.onChange=this.onChange=t}registerOnTouched(t){this.onTouch=t}_getActiveElement(t=this.document){let e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}checkSelectionOnDeletion(t){let e=this.prefix().length,n=this.suffix().length,r=this._inputValue().length;t.selectionStart=Math.min(Math.max(e,t.selectionStart),r-n),t.selectionEnd=Math.min(Math.max(e,t.selectionEnd),r-n)}setDisabledState(t){this._maskService.formElementProperty=["disabled",t]}_applyMask(){this._maskService.maskExpression=this._maskService._repeatPatternSymbols(this._maskValue()||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue(),this._maskService.maskExpression)]}_validateTime(t){let e=this._maskValue().split(i.EMPTY_STRING).filter(n=>n!==":").length;return t&&(+(t[t.length-1]??-1)==0&&t.length<e||t.length<=e-2)?this._createValidationError(t):null}_getActualInputLength(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}_createValidationError(t){return{mask:{requiredMask:this._maskValue(),actualValue:t}}}_setMask(){this._maskExpressionArray().some(t=>{if(t.split(i.EMPTY_STRING).some(n=>this._maskService.specialCharacters.includes(n))&&this._inputValue()&&this._areAllCharactersInEachStringSame(this._maskExpressionArray())||t.includes(i.CURLY_BRACKETS_LEFT)){let n=this._maskService.removeMask(this._inputValue())?.length<=this._maskService.removeMask(t)?.length;if(n){let r=t.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(t):t;return this._maskValue.set(r),this._maskService.maskExpression=r,n}else{let r=this._maskExpressionArray()[this._maskExpressionArray().length-1]??i.EMPTY_STRING,o=r.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(r):r;this._maskValue.set(o),this._maskService.maskExpression=o}}else{let n=this._maskService.removeMask(t),r=this._maskService.removeMask(this._inputValue())?.split(i.EMPTY_STRING).every((o,u)=>{let a=n.charAt(u);return this._maskService._checkSymbolMask(o,a)});if(r||this._justPasted())return this._maskValue.set(t),this._maskService.maskExpression=t,r}})}_areAllCharactersInEachStringSame(t){let e=this._maskService.specialCharacters;function n(o){let u=new RegExp(`[${e.map(a=>`\\${a}`).join("")}]`,"g");return o.replace(u,"")}return t.map(n).every(o=>new Set(o).size===1)}static \u0275fac=function(e){return new(e||c)};static \u0275dir=re({type:c,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function(e,n){e&1&&se("paste",function(){return n.onPaste()})("focus",function(o){return n.onFocus(o)})("ngModelChange",function(o){return n.onModelChange(o)})("input",function(o){return n.onInput(o)})("compositionstart",function(o){return n.onCompositionStart(o)})("compositionend",function(o){return n.onCompositionEnd(o)})("blur",function(o){return n.onBlur(o)})("click",function(o){return n.onClick(o)})("keydown",function(o){return n.onKeyDown(o)})},inputs:{mask:[1,"mask"],specialCharacters:[1,"specialCharacters"],patterns:[1,"patterns"],prefix:[1,"prefix"],suffix:[1,"suffix"],thousandSeparator:[1,"thousandSeparator"],decimalMarker:[1,"decimalMarker"],dropSpecialCharacters:[1,"dropSpecialCharacters"],hiddenInput:[1,"hiddenInput"],showMaskTyped:[1,"showMaskTyped"],placeHolderCharacter:[1,"placeHolderCharacter"],shownMaskExpression:[1,"shownMaskExpression"],clearIfNotMatch:[1,"clearIfNotMatch"],validation:[1,"validation"],separatorLimit:[1,"separatorLimit"],allowNegativeNumbers:[1,"allowNegativeNumbers"],leadZeroDateTime:[1,"leadZeroDateTime"],leadZero:[1,"leadZero"],triggerOnMaskChange:[1,"triggerOnMaskChange"],apm:[1,"apm"],inputTransformFn:[1,"inputTransformFn"],outputTransformFn:[1,"outputTransformFn"],keepCharacterPositions:[1,"keepCharacterPositions"],instantPrefix:[1,"instantPrefix"]},outputs:{maskFilled:"maskFilled"},exportAs:["mask","ngxMask"],features:[ne([{provide:ae,useExisting:c,multi:!0},{provide:oe,useExisting:c,multi:!0},q]),J]})}return c})();export{Me as a,it as b,rt as c};
